/* Write your T-SQL query statement below */

/* https://leetcode.com/problems/group-sold-products-by-the-date */

select 
    sell_date,
    num_sold = count ( product ),
    products = string_agg ( product, ',' ) within group ( order by product asc )
from
    (
        select distinct sell_date, product
        from Activities
    ) tab
group by sell_date
order by sell_date